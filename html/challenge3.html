<!DOCTYPE html>
<html>

<head>

    <title>SQL Injection</title>

    <link rel="shortcut icon" type="image/x-icon"
        href="https://d1o5lmfp4gliop.cloudfront.net/assets/favicon-d2fd4b2666fd6a6c2eacee13d0d844a558942079e549b7f971085de9cab55511.ico" />

    <link rel="apple-touch-icon" href="/touch-icon-iphone.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/touch-icon-ipad.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/touch-icon-iphone-retina.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/touch-icon-ipad-retina.png">

    <meta name="viewport" content="width=device-width">

    <link rel="stylesheet" media="all"
        href="https://d1o5lmfp4gliop.cloudfront.net/assets/application-1f27c21e9caba5e224e9039708363bb3d6393bcd0cec34182ef97d314c3d7fe1.css" />
    <script
        src="https://d1o5lmfp4gliop.cloudfront.net/assets/application-9865c3a61c1ffdfed4986c79c8214c39119b9dd0fa2157ea9bdc023c8edbd459.js"></script>

    <meta name="viewport" content="width=device-width, initial-scale=1">

    <meta name="csrf-param" content="authenticity_token" />
    <meta name="csrf-token"
        content="XQZZUTqJxdYA2bqSgdC4T2mQ55sY19lv+NHHuZflzpLoGaW5zbEwZomHZkrsOMqhpsApGn4LFzrMGrmsyw3DEA==" />



    <meta property="og:url" content="https://www.hacksplaining.com/exercises/sql-injection" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="SQL Injection" />
    <meta property="og:description"
        content="If you are vulnerable to SQL Injection, attackers can run arbitrary commands against your database. Ready to see how? →" />
    <meta property="og:image"
        content="https://www.hacksplaining.comhttps://d1o5lmfp4gliop.cloudfront.net/images/exercises/sql-injection/screenshot.png" />
    <meta property="og:site_name" content="Hacksplaining" />

    <meta property="fb:app_id" content="495778420623064">

    <meta name="description"
        content="If you are vulnerable to SQL Injection, attackers can run arbitrary commands against your database. Ready to see how? →" />

    <meta name="twitter:title" content="SQL Injection">
    <meta name="twitter:description"
        content="If you are vulnerable to SQL Injection, attackers can run arbitrary commands against your database. Ready to see how? → %>">

    <meta name="application-name" content="Hacksplaining" />
    <meta name="msapplication-TileColor" content="#000000" />
    <meta name="msapplication-square70x70logo" content="windows-tiny.png" />
    <meta name="msapplication-square150x150logo" content="windows-square.png" />
    <meta name="msapplication-wide310x150logo" content="windows-wide.png" />
    <meta name="msapplication-square310x310logo" content="windows-large.png" />



    <script>
        let _rollbarConfig = {
            accessToken: "7292cc33ae3843d4bc12aa01e4d82436",
            captureUncaught: true,
            captureUnhandledRejections: true,
            payload: {
                environment: "production",
                user: "unknown"
            },
            checkIgnore: function (isUncaught, args, payload) {
                // Code here to determine whether or not to send the payload to the Rollbar API
                return !!(args && args[1] && (args[1].indexOf("Can't find variable") !== -1));
            },
            hostSafeList: ['hacksplaining.com', 'www.hacksplaining.com', 'app.hacksplaining.com'],
            ignoredMessages: [
                "jQuery is missing",
                "\\$ is not defined",
                "Can't find variable ga",
                "Uncaught SyntaxError",
                "Cannot read properties of null",
                "reCAPTCHA"
            ]
        };

        !function (r) { var e = {}; function o(n) { if (e[n]) return e[n].exports; var t = e[n] = { i: n, l: !1, exports: {} }; return r[n].call(t.exports, t, t.exports, o), t.l = !0, t.exports } o.m = r, o.c = e, o.d = function (r, e, n) { o.o(r, e) || Object.defineProperty(r, e, { enumerable: !0, get: n }) }, o.r = function (r) { "undefined" != typeof Symbol && Symbol.toStringTag && Object.defineProperty(r, Symbol.toStringTag, { value: "Module" }), Object.defineProperty(r, "__esModule", { value: !0 }) }, o.t = function (r, e) { if (1 & e && (r = o(r)), 8 & e) return r; if (4 & e && "object" == typeof r && r && r.__esModule) return r; var n = Object.create(null); if (o.r(n), Object.defineProperty(n, "default", { enumerable: !0, value: r }), 2 & e && "string" != typeof r) for (var t in r) o.d(n, t, function (e) { return r[e] }.bind(null, t)); return n }, o.n = function (r) { var e = r && r.__esModule ? function () { return r.default } : function () { return r }; return o.d(e, "a", e), e }, o.o = function (r, e) { return Object.prototype.hasOwnProperty.call(r, e) }, o.p = "", o(o.s = 0) }([function (r, e, o) { var n = o(1), t = o(4); _rollbarConfig = _rollbarConfig || {}, _rollbarConfig.rollbarJsUrl = _rollbarConfig.rollbarJsUrl || "https://cdnjs.cloudflare.com/ajax/libs/rollbar.js/2.13.0/rollbar.min.js", _rollbarConfig.async = void 0 === _rollbarConfig.async || _rollbarConfig.async; var a = n.setupShim(window, _rollbarConfig), l = t(_rollbarConfig); window.rollbar = n.Rollbar, a.loadFull(window, document, !_rollbarConfig.async, _rollbarConfig, l) }, function (r, e, o) { var n = o(2); function t(r) { return function () { try { return r.apply(this, arguments) } catch (r) { try { console.error("[Rollbar]: Internal error", r) } catch (r) { } } } } var a = 0; function l(r, e) { this.options = r, this._rollbarOldOnError = null; var o = a++; this.shimId = function () { return o }, "undefined" != typeof window && window._rollbarShims && (window._rollbarShims[o] = { handler: e, messages: [] }) } var i = o(3), s = function (r, e) { return new l(r, e) }, d = function (r) { return new i(s, r) }; function c(r) { return t(function () { var e = Array.prototype.slice.call(arguments, 0), o = { shim: this, method: r, args: e, ts: new Date }; window._rollbarShims[this.shimId()].messages.push(o) }) } l.prototype.loadFull = function (r, e, o, n, a) { var l = !1, i = e.createElement("script"), s = e.getElementsByTagName("script")[0], d = s.parentNode; i.crossOrigin = "", i.src = n.rollbarJsUrl, o || (i.async = !0), i.onload = i.onreadystatechange = t(function () { if (!(l || this.readyState && "loaded" !== this.readyState && "complete" !== this.readyState)) { i.onload = i.onreadystatechange = null; try { d.removeChild(i) } catch (r) { } l = !0, function () { var e; if (void 0 === r._rollbarDidLoad) { e = new Error("rollbar.js did not load"); for (var o, n, t, l, i = 0; o = r._rollbarShims[i++];)for (o = o.messages || []; n = o.shift();)for (t = n.args || [], i = 0; i < t.length; ++i)if ("function" == typeof (l = t[i])) { l(e); break } } "function" == typeof a && a(e) }() } }), d.insertBefore(i, s) }, l.prototype.wrap = function (r, e, o) { try { var n; if (n = "function" == typeof e ? e : function () { return e || {} }, "function" != typeof r) return r; if (r._isWrap) return r; if (!r._rollbar_wrapped && (r._rollbar_wrapped = function () { o && "function" == typeof o && o.apply(this, arguments); try { return r.apply(this, arguments) } catch (o) { var e = o; throw e && ("string" == typeof e && (e = new String(e)), e._rollbarContext = n() || {}, e._rollbarContext._wrappedSource = r.toString(), window._rollbarWrappedError = e), e } }, r._rollbar_wrapped._isWrap = !0, r.hasOwnProperty)) for (var t in r) r.hasOwnProperty(t) && (r._rollbar_wrapped[t] = r[t]); return r._rollbar_wrapped } catch (e) { return r } }; for (var p = "log,debug,info,warn,warning,error,critical,global,configure,handleUncaughtException,handleAnonymousErrors,handleUnhandledRejection,captureEvent,captureDomContentLoaded,captureLoad".split(","), u = 0; u < p.length; ++u)l.prototype[p[u]] = c(p[u]); r.exports = { setupShim: function (r, e) { if (r) { var o = e.globalAlias || "Rollbar"; if ("object" == typeof r[o]) return r[o]; r._rollbarShims = {}, r._rollbarWrappedError = null; var a = new d(e); return t(function () { e.captureUncaught && (a._rollbarOldOnError = r.onerror, n.captureUncaughtExceptions(r, a, !0), e.wrapGlobalEventHandlers && n.wrapGlobals(r, a, !0)), e.captureUnhandledRejections && n.captureUnhandledRejections(r, a, !0); var t = e.autoInstrument; return !1 !== e.enabled && (void 0 === t || !0 === t || "object" == typeof t && t.network) && r.addEventListener && (r.addEventListener("load", a.captureLoad.bind(a)), r.addEventListener("DOMContentLoaded", a.captureDomContentLoaded.bind(a))), r[o] = a, a })() } }, Rollbar: d } }, function (r, e) { function o(r, e, o) { if (e.hasOwnProperty && e.hasOwnProperty("addEventListener")) { for (var n = e.addEventListener; n._rollbarOldAdd && n.belongsToShim;)n = n._rollbarOldAdd; var t = function (e, o, t) { n.call(this, e, r.wrap(o), t) }; t._rollbarOldAdd = n, t.belongsToShim = o, e.addEventListener = t; for (var a = e.removeEventListener; a._rollbarOldRemove && a.belongsToShim;)a = a._rollbarOldRemove; var l = function (r, e, o) { a.call(this, r, e && e._rollbar_wrapped || e, o) }; l._rollbarOldRemove = a, l.belongsToShim = o, e.removeEventListener = l } } r.exports = { captureUncaughtExceptions: function (r, e, o) { if (r) { var n; if ("function" == typeof e._rollbarOldOnError) n = e._rollbarOldOnError; else if (r.onerror) { for (n = r.onerror; n._rollbarOldOnError;)n = n._rollbarOldOnError; e._rollbarOldOnError = n } e.handleAnonymousErrors(); var t = function () { var o = Array.prototype.slice.call(arguments, 0); !function (r, e, o, n) { r._rollbarWrappedError && (n[4] || (n[4] = r._rollbarWrappedError), n[5] || (n[5] = r._rollbarWrappedError._rollbarContext), r._rollbarWrappedError = null); var t = e.handleUncaughtException.apply(e, n); o && o.apply(r, n), "anonymous" === t && (e.anonymousErrorsPending += 1) }(r, e, n, o) }; o && (t._rollbarOldOnError = n), r.onerror = t } }, captureUnhandledRejections: function (r, e, o) { if (r) { "function" == typeof r._rollbarURH && r._rollbarURH.belongsToShim && r.removeEventListener("unhandledrejection", r._rollbarURH); var n = function (r) { var o, n, t; try { o = r.reason } catch (r) { o = void 0 } try { n = r.promise } catch (r) { n = "[unhandledrejection] error getting `promise` from event" } try { t = r.detail, !o && t && (o = t.reason, n = t.promise) } catch (r) { } o || (o = "[unhandledrejection] error getting `reason` from event"), e && e.handleUnhandledRejection && e.handleUnhandledRejection(o, n) }; n.belongsToShim = o, r._rollbarURH = n, r.addEventListener("unhandledrejection", n) } }, wrapGlobals: function (r, e, n) { if (r) { var t, a, l = "EventTarget,Window,Node,ApplicationCache,AudioTrackList,ChannelMergerNode,CryptoOperation,EventSource,FileReader,HTMLUnknownElement,IDBDatabase,IDBRequest,IDBTransaction,KeyOperation,MediaController,MessagePort,ModalWindow,Notification,SVGElementInstance,Screen,TextTrack,TextTrackCue,TextTrackList,WebSocket,WebSocketWorker,Worker,XMLHttpRequest,XMLHttpRequestEventTarget,XMLHttpRequestUpload".split(","); for (t = 0; t < l.length; ++t)r[a = l[t]] && r[a].prototype && o(e, r[a].prototype, n) } } } }, function (r, e) { function o(r, e) { this.impl = r(e, this), this.options = e, function (r) { for (var e = function (r) { return function () { var e = Array.prototype.slice.call(arguments, 0); if (this.impl[r]) return this.impl[r].apply(this.impl, e) } }, o = "log,debug,info,warn,warning,error,critical,global,configure,handleUncaughtException,handleAnonymousErrors,handleUnhandledRejection,_createItem,wrap,loadFull,shimId,captureEvent,captureDomContentLoaded,captureLoad".split(","), n = 0; n < o.length; n++)r[o[n]] = e(o[n]) }(o.prototype) } o.prototype._swapAndProcessMessages = function (r, e) { var o, n, t; for (this.impl = r(this.options); o = e.shift();)n = o.method, t = o.args, this[n] && "function" == typeof this[n] && ("captureDomContentLoaded" === n || "captureLoad" === n ? this[n].apply(this, [t[0], o.ts]) : this[n].apply(this, t)); return this }, r.exports = o }, function (r, e) { r.exports = function (r) { return function (e) { if (!e && !window._rollbarInitialized) { for (var o, n, t = (r = r || {}).globalAlias || "Rollbar", a = window.rollbar, l = function (r) { return new a(r) }, i = 0; o = window._rollbarShims[i++];)n || (n = o.handler), o.handler._swapAndProcessMessages(l, o.messages); window[t] = n, window._rollbarInitialized = !0 } } } }]);

    </script>
</head>

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-SZ91HC6JB6"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'G-SZ91HC6JB6');
</script>

<body class="off-white logged-out exercises sql_injection unknown_device chrome windows webkit non-ie">
    <div class="content">
        <div class="exercise-title">
            <a href="#">
                <div class="inline">
                    <img class="logo"
                        src="https://d1o5lmfp4gliop.cloudfront.net/images/exercises/sql-injection/icon.gif" />
                </div>
                <div class="inline title">
                    <div>
                        SQL Injection
                    </div>
                    <div class="tracking"></div>
                </div>
                <a class="back-to-lessons" href="/lessons">
                    <i class="fa fa-times-circle back-icon"></i>
                    <div class="back-label">Exit</div>
                </a>
            </a>
        </div>
        <noscript>
            <div class="row">
                <p class="alert alert-danger no-script">
                    This site needs JavaScript to work!
                </p>
            </div>
        </noscript>
        <div class="main exercise">
            <div class="card-holder">
                <div id="intro" class="intro">
                    <a id="start-exercise" href="#start">
                        <div class="card">
                            <div class="img porthole"
                                style="background-color: white; background-position: center; background-repeat: no-repeat; background-image: url('https://d1o5lmfp4gliop.cloudfront.net/images/exercises/sql-injection/icon.gif')">
                            </div>

                            <div class="strip">
                                SQL Injection
                            </div>
                            <div class="blurb">

                                <p>If you are vulnerable to SQL Injection, attackers can run arbitrary commands against
                                    your database.</p>

                                <p>
                                    <strong>
                                        Ready to see how?
                                    </strong>
                                </p>

                            </div>
                        </div>
                    </a>
                </div>
            </div>

            <div class="lesson-holder">
                <div class="lesson" data-name="SQL Injection" data-id="sql_injection" data-captions="on">



                    <script>
                        var footerClass = "off-white";
                        var lessonBackground = "#efefef";
                    </script>


                    <div id="sql-injection">
                        <div class="container">
                            <div class="row">

                                <div class="col-sm-3"> </div>

                                <div class="col-sm-6">

                                    <a class="unselectable" href="/prevention/sql-injection">
                                        <div id="finish" class=" instruction" title="How do we prevent this?">

                                            <div class="icon">
                                                <img
                                                    src="https://d1o5lmfp4gliop.cloudfront.net/assets/skull-56af21599bf07cebbffbecceec1537a9471628fb1d3374433c1d9b8b1ab703bf.png" />
                                            </div>

                                            <div class="message">
                                                <strong>Phew.</strong> Now we know how <span class="vulnerability">SQL
                                                    injection</span>
                                                works, let's learn how to protect against this kind of attack.
                                            </div>

                                            <div class="next"></div>
                                        </div>
                                    </a>
                                </div>

                                <div class="col-sm-3"> </div>

                            </div>
                        </div>

                        <div class="container">
                            <div class="row">
                                <div id="app-instructions" class="col-md-3">

                                    <div class="instructions">

                                        <div class="spacier">
                                            <a class="unselectable" href="#introducing-log">
                                                <div id="start" class="points-right instruction" show="#app,#app .blur"
                                                    title="Start" next="introducing-log">

                                                    <strong>
                                                        This is the vulnerable application we will be trying to
                                                        hack with a <span class="vulnerability">SQL injection</span>
                                                        attack.
                                                    </strong>

                                                    <div class="next"></div>
                                                </div>
                                            </a>
                                        </div>

                                        <a class="unselectable" href="#second-login-attempt">
                                            <div id="first-login-attempt" class="points-right instruction"
                                                show="#app,#log" title="First Login Attempt"
                                                transcript="First, let&#39;s try guessing the password."
                                                next="second-login-attempt" await="invalidLogin">

                                                <strong>Go ahead and try logging in with the following
                                                    credentials:</strong>

                                                <div class="login">
                                                    <div class="row">
                                                        <div class="field">
                                                            Email
                                                        </div>
                                                        <div class="value">
                                                            user@email.com
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="field">
                                                            Password
                                                        </div>
                                                        <div class="value">
                                                            password
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="next hidden"></div>
                                            </div>
                                        </a>
                                        <script>
                                            function invalidLogin() {
                                                var url = $("#frame").data('url');
                                                return (url.indexOf('invalid') > -1);
                                            }
                                        </script>

                                        <a class="unselectable" href="#after-server-error">
                                            <div id="second-login-attempt" class="points-right instruction"
                                                show="#app,#log" title="Second Login Attempt"
                                                transcript="Okay, so guessing the password didn&#39;t work. Let&#39;s try adding a quote character after the password."
                                                next="after-server-error" await="unexpectedError">

                                                <strong>Okay, so guessing the password didn't work.</strong>
                                                Let's try adding a quote character after the password:

                                                <div class="login">
                                                    <div class="row">
                                                        <div class="field">
                                                            Email
                                                        </div>
                                                        <div class="value">
                                                            user@email.com
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="field">
                                                            Password
                                                        </div>
                                                        <div class="value">
                                                            password'
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="next hidden"></div>
                                            </div>
                                        </a>
                                        <script>
                                            function unexpectedError() {
                                                var url = $("#frame").data('url');
                                                return (url.indexOf('unexpected') > -1);
                                            }
                                        </script>

                                        <div class="spacier">
                                            <a class="unselectable" href="#error-log">
                                                <div id="after-server-error" class="points-right instruction"
                                                    show="#app,#log" title="Server Error"
                                                    transcript="The application crashed with an unexpected error. What could that mean?"
                                                    next="error-log">

                                                    <strong>Hmmm.</strong> The application crashed with an unexpected
                                                    error.
                                                    What could that mean?

                                                    <div class="next"></div>
                                                </div>
                                            </a>
                                        </div>

                                        <div class="spacier">
                                            <a class="unselectable" href="#sql-injection-explanation">
                                                <div id="third-login-attempt" class="points-right instruction"
                                                    show="#app,#log,#code" title="Experimenting with Passwords"
                                                    transcript="Let&#39;s enter the password with a trailing quote character once more."
                                                    next="sql-injection-explanation">

                                                    <strong>Enter the password <span class="input">password'</span> and
                                                        watch the code window.</strong>

                                                    <div class="next"></div>
                                                </div>
                                            </a>
                                        </div>

                                        <a class="unselectable" href="#hack-complete">
                                            <div id="fourth-login-attempt" class="points-right instruction"
                                                show="#app,#log,#code" title="Hacking the System"
                                                transcript="Now, let&#39;s a specifically crafted password."
                                                next="hack-complete" await="authenticationBypassed">

                                                <p>
                                                    Enter the following credentials and click "Log in":
                                                </p>

                                                <div class="login">
                                                    <div class="row">
                                                        <div class="field">
                                                            Email
                                                        </div>
                                                        <div class="value">
                                                            user@email.com
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="field">
                                                            Password
                                                        </div>
                                                        <div class="value">
                                                            ' or 1=1--
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="next hidden"></div>
                                            </div>
                                        </a>
                                        <script>
                                            function authenticationBypassed() {
                                                var url = $("#frame").data('url');
                                                return (url.indexOf('account') > -1);
                                            }
                                        </script>

                                        <div class="spacier">
                                            <a class="unselectable" href="#sql-injection-footnote">
                                                <div id="hack-complete" class="points-right instruction"
                                                    show="#app,#log,#code" title="Hack complete!"
                                                    next="sql-injection-footnote">

                                                    <strong>And we are in!</strong>

                                                    We successfully gained access to the application without having
                                                    to guess the password, using <span class="vulnerability">SQL
                                                        injection</span>.

                                                    <div class="next"></div>
                                                </div>
                                            </a>
                                        </div>

                                    </div>

                                </div>

                                <div id="app" class="col-md-9 hide-by-default">

                                    <div class="pane-title">Application</div>

                                    <div class="pane">
                                        <div id="blur" class="blur hide-by-default"></div>

                                        <iframe id="frame" width="100%" height="100%" scrolling="no"
                                            src="https://www.hacksplaining.com/embedded/sql-injection/logout"
                                            style="background: #ddd">

                                            <!-- Vulnerable application shown here. -->

                                        </iframe>
                                    </div>

                                </div>
                            </div>
                        </div>

                        <div class="container">
                            <div class="row">
                                <div id="log" class="col-sm-auto hide-by-default">

                                    <div class="pane-title">Logs</div>

                                    <div class="pane">
                                        <iframe width="100%" height="100%"
                                            src="https://www.hacksplaining.com/embedded/sql-injection/logs">

                                            <!-- Application logs go here. -->

                                        </iframe>
                                    </div>

                                    <a class="unselectable" href="#first-login-attempt">
                                        <div id="introducing-log" class="points-up instruction"
                                            show="#app,#log,#app .blur" title="The Log Window"
                                            transcript="Here are the application logs. Watch what happens here when we interact with the vulnerable application."
                                            next="first-login-attempt">

                                            <strong>Here are the application logs.</strong>

                                            Watch what happens here when you interact with the
                                            vulnerable application.

                                            <div class="next"></div>
                                        </div>
                                    </a>
                                    <a class="unselectable" href="#introducing-code">
                                        <div id="error-log" class="points-up instruction" show="#app,#log,#app .blur"
                                            title="A Suspicious Error" next="introducing-code">

                                            <strong>The logs show a SQL syntax error.</strong>

                                            This indicates that the quote character messed something up in an
                                            unexpected way.

                                            <div class="next"></div>
                                        </div>
                                    </a>
                                </div>

                                <div id="code" class="col-sm-auto hide-by-default">

                                    <div class="pane-title">Code</div>

                                    <div class="pane">
                                        <pre class="code-sql code">
            <div id="source-code">

              <!-- SQL statements go here -->

            </div>
          </pre>

                                        <div id="raw-code">SELECT *
                                            FROM users
                                            WHERE email = '#email#'
                                            AND pass = '#password#' LIMIT 1</div>
                                    </div>

                                    <a class="unselectable" href="#third-login-attempt">
                                        <div id="introducing-code" class="points-up instruction"
                                            show="#app,#log,#app .blur, #code" title="Checking the Code"
                                            transcript="This is what the application code looks like behind the scenes. Watch how the SQL code gets built as we enter the login details."
                                            next="third-login-attempt">

                                            <strong>This is what the application code looks like behind the
                                                scenes.</strong>

                                            <div class="next"></div>
                                        </div>
                                    </a>
                                    <a class="unselectable" href="#sql-injection-vulnerability">
                                        <div id="sql-injection-explanation" class="points-up instruction"
                                            show="#app,#log,#app .blur,#code" title="Injection Explained"
                                            next="sql-injection-vulnerability">

                                            <strong>The quote is inserted directly into the SQL string, and terminates
                                                the query early.</strong> This is what caused the syntax error we saw in
                                            the logs.

                                            <div class="next"></div>
                                        </div>
                                    </a>
                                    <a class="unselectable" href="#fourth-login-attempt">
                                        <div id="sql-injection-vulnerability" class="points-up instruction"
                                            show="#app,#log,#app .blur,#code" title="Injection = Vulnerability"
                                            next="fourth-login-attempt">

                                            This behavior indicates that the application might be vulnerable
                                            to <span class="vulnerability">SQL injection</span>.

                                            <div class="next"></div>
                                        </div>
                                    </a>
                                    <a class="unselectable" href="#finish">
                                        <div id="sql-injection-footnote" class="points-up instruction"
                                            show="#app,#log,#app .blur,#code" title="A Bit More Detail"
                                            transcript="The double dashes we entered caused the the database to ignore the rest of the SQL statement, allowing us to be authenticated without having to supply the real password."
                                            next="finish">

                                            The <span class="code-comment">--</span> characters you entered caused
                                            the database to ignore the rest of the SQL statement, allowing you to be
                                            authenticated without having to supply the real password.

                                            <div class="next"></div>
                                        </div>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>

                    <script>
                        $(function () {
                            var messageNo = 0;
                            var email = "?";
                            var password = "?";

                            /**
                             * Call back from embedded application - e.g. when the email or password
                             * fields are updated, or the page has been reloaded. Update the SQL in the
                             * code window, making sure to re-do syntax highlighting, and make a note
                             * of the new URL.
                             */
                            var eventMethod = window.addEventListener ? "addEventListener" : "attachEvent";
                            var eventHandler = window[eventMethod];
                            var messageEvent = eventMethod === "attachEvent" ? "onmessage" : "message";

                            eventHandler(messageEvent, function (e) {
                                var key = e.message ? "message" : "data";
                                var data = e[key]

                                try {
                                    data = JSON.parse(data);
                                }
                                catch (error) {
                                    var description = "{ data: " + e.data + ", message: " + e.message + ", origin: " + e.origin + " }"
                                    var logMessage = "Unable to parse JSON in postMessage() event. Event looks like: " + description + ", error was: " + error + ". (Message no " + messageNo + ")"

                                    console.log(logMessage)

                                    return
                                }

                                messageNo = messageNo + 1;

                                $("#frame").data('url', data.url)

                                if (data.event === 'keystroke') {
                                    email = data.email;
                                    password = data.password;

                                    var newCode = $("#raw-code").text();

                                    newCode = newCode.replace("#email#", email);
                                    newCode = newCode.replace("#password#", password);

                                    hljs.configure({ classPrefix: 'code-' })

                                    $("#source-code").html('<code class="sql">' + newCode + '</code>');

                                    $('.sql').each(function (i, e) {
                                        hljs.highlightBlock(e)
                                    });
                                }

                                if (awaitingInteraction() && interactionOccurred()) {
                                    console.log("Interaction happened, proceeding to next step.")
                                    nextStep();
                                }
                            }, false);
                        })
                    </script>
                </div>
            </div>
        </div>


        <script
            src="https://d1o5lmfp4gliop.cloudfront.net/assets/exercise-5652b5b649e3d7688a1c4e39179541168716b52f4d2d6c72ea0210af3eebe078.js"></script>
    </div>

    <script
        src="https://d1o5lmfp4gliop.cloudfront.net/assets/cookieinfo-1af9cc137c2c2bc8ea4d469f45d357ec43dc6c23537bd0c96aa9b51ff416ce5e.js"
        id="cookieinfo"></script>
</body>

<script>
    $(function () {
        $('[data-bs-toggle="tooltip"]').tooltip({ container: 'body' });
    });
</script>

</html>